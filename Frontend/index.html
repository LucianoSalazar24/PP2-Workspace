<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reserva de Canchas de F√∫tbol</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/components.css">
</head>
<body>
<!-- Header para index.html -->
<header class="header">
    <div class="container">
        <div class="logo">
            <span class="logo-icon">‚öΩ</span>
            <h1>FutbolReservas</h1>
        </div>
        <nav class="nav" style="display: flex; align-items: center; gap: 1rem;">
            <a href="index.html" class="nav-link active">Inicio</a>
            <a href="#" onclick="irAReservar(event)" class="nav-link">Reservar</a>
            <a href="#" onclick="irAAdmin(event)" class="nav-link">Panel Admin</a>
            
            <!-- Bot√≥n de cerrar sesi√≥n (se muestra solo si hay sesi√≥n) -->
            <button id="btnCerrarSesion" onclick="cerrarSesionGlobal()" class="btn btn-outline" style="display: none; padding: 0.5rem 1rem; font-size: 0.9rem;">
                üö™ Cerrar Sesi√≥n
            </button>
            
            <!-- Mostrar usuario actual -->
            <span id="usuarioActual" style="display: none; color: white; font-size: 0.9rem;"></span>
        </nav>
    </div>
</header>

<!-- Script para manejar navegaci√≥n inteligente -->
<script>
// Verificar si hay sesi√≥n y mostrar bot√≥n
document.addEventListener('DOMContentLoaded', () => {
    const sesionStr = sessionStorage.getItem('sesion');
    const btnCerrarSesion = document.getElementById('btnCerrarSesion');
    const usuarioActual = document.getElementById('usuarioActual');
    
    if (sesionStr && btnCerrarSesion) {
        const sesion = JSON.parse(sesionStr);
        btnCerrarSesion.style.display = 'block';
        
        if (usuarioActual) {
            usuarioActual.textContent = `üë§ ${sesion.nombre}`;
            usuarioActual.style.display = 'block';
        }
    }
});

function irAReservar(e) {
    e.preventDefault();
    const sesion = sessionStorage.getItem('sesion');
    
    if (sesion) {
        // Si hay sesi√≥n, ir directo a reservar
        window.location.href = 'pages/reservar.html';
    } else {
        // Si no hay sesi√≥n, ir al login
        window.location.href = 'pages/login.html';
    }
}

function irAAdmin(e) {
    e.preventDefault();
    
    const sesionStr = sessionStorage.getItem('sesion');
    
    if (sesionStr) {
        const sesion = JSON.parse(sesionStr);
        
        // Si ya es admin, ir directo al panel
        if (sesion.rol === 'admin') {
            window.location.href = 'pages/admin.html';
            return;
        }
        
        // Si es cliente, preguntar si quiere cerrar sesi√≥n para entrar como admin
        if (confirm('Para acceder al Panel Admin debes cerrar tu sesi√≥n actual. ¬øContinuar?')) {
            sessionStorage.removeItem('sesion');
            window.location.href = 'pages/login.html?admin=true';
        }
    } else {
        // Si no hay sesi√≥n, ir al login
        window.location.href = 'pages/login.html?admin=true';
    }
}

function cerrarSesionGlobal() {
    if (confirm('¬øEst√°s seguro que deseas cerrar sesi√≥n?')) {
        sessionStorage.removeItem('sesion');
        window.location.href = 'index.html';
    }
}
</script>

<style>
.nav {
    display: flex;
    align-items: center;
    gap: 1rem;
}

#btnCerrarSesion {
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.3);
    color: white;
    cursor: pointer;
    border-radius: 6px;
    transition: all 0.3s;
}

#btnCerrarSesion:hover {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.5);
}

#usuarioActual {
    background: rgba(255, 255, 255, 0.1);
    padding: 0.5rem 1rem;
    border-radius: 6px;
    font-weight: 500;
}
</style>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-overlay"></div>
        <div class="hero-content">
            <h2 class="hero-title">Reserv√° tu Cancha de F√∫tbol</h2>
            <p class="hero-subtitle">Sistema r√°pido, f√°cil y confiable para reservar canchas</p>
            <a href="pages/login.html" class="btn btn-primary btn-large">
                Hacer una Reserva
            </a>
        </div>
    </section>

    <!-- Caracter√≠sticas -->
    <section class="features">
        <div class="container">
            <h2 class="section-title">¬øPor qu√© elegirnos?</h2>
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">üìÖ</div>
                    <h3>Reserva Online</h3>
                    <p>Reserv√° desde cualquier lugar, las 24 horas del d√≠a. Sin necesidad de llamar por tel√©fono.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">‚ö°</div>
                    <h3>Confirmaci√≥n Inmediata</h3>
                    <p>Obten√© confirmaci√≥n instant√°nea de tu reserva. Sin esperas ni confusiones.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üí∞</div>
                    <h3>Descuentos por Frecuencia</h3>
                    <p>Los clientes frecuentes obtienen descuentos especiales autom√°ticamente.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üèüÔ∏è</div>
                    <h3>Canchas de Calidad</h3>
                    <p>Canchas con c√©sped sint√©tico de √∫ltima generaci√≥n, perfectamente mantenidas.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Nuestras Canchas -->
    <section class="canchas-preview">
        <div class="container">
            <h2 class="section-title">Nuestras Canchas</h2>
            <div id="canchasContainer" class="canchas-grid">
                <!-- Las canchas se cargar√°n din√°micamente aqu√≠ -->
                <div class="loader-container">
                    <div class="loader">Cargando canchas...</div>
                </div>
            </div>
        </div>
    </section>

    <!-- C√≥mo Funciona -->
    <section class="how-it-works">
        <div class="container">
            <h2 class="section-title">¬øC√≥mo Funciona?</h2>
            <div class="steps">
                <div class="step">
                    <div class="step-number">1</div>
                    <h3>Eleg√≠ tu Cancha</h3>
                    <p>Seleccion√° la cancha que mejor se adapte a tus necesidades</p>
                </div>
                <div class="step-arrow">‚Üí</div>
                <div class="step">
                    <div class="step-number">2</div>
                    <h3>Seleccion√° Fecha y Horario</h3>
                    <p>Verific√° la disponibilidad y eleg√≠ el horario que prefieras</p>
                </div>
                <div class="step-arrow">‚Üí</div>
                <div class="step">
                    <div class="step-number">3</div>
                    <h3>Complet√° tus Datos</h3>
                    <p>Ingres√° tu informaci√≥n de contacto</p>
                </div>
                <div class="step-arrow">‚Üí</div>
                <div class="step">
                    <div class="step-number">4</div>
                    <h3>Confirm√° y Pag√°</h3>
                    <p>Recib√≠ tu confirmaci√≥n y disfrut√° del partido</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Informaci√≥n de Contacto -->
    <section class="contact-info">
        <div class="container">
            <div class="contact-grid">
                <div class="contact-item">
                    <div class="contact-icon">üìç</div>
                    <h3>Ubicaci√≥n</h3>
                    <p>Buenos Aires, Argentina</p>
                </div>
                <div class="contact-item">
                    <div class="contact-icon">‚è∞</div>
                    <h3>Horarios</h3>
                    <p>Lunes a Domingo<br>08:00 - 23:00</p>
                </div>
                <div class="contact-item">
                    <div class="contact-icon">üìû</div>
                    <h3>Contacto</h3>
                    <p>Reserv√° llamando al<br>(011) 1234-5678</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 FutbolReservas - Sistema de Reservas de Canchas</p>
            <p>Desarrollado por Luciano Salazar</p>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="js/config.js"></script>
    <script src="js/api.js"></script>
    <script src="js/utils.js"></script>
    <script>
        // Cargar canchas disponibles al iniciar la p√°gina
        document.addEventListener('DOMContentLoaded', async () => {
            await cargarCanchas();
        });

        async function cargarCanchas() {
            const container = document.getElementById('canchasContainer');
            
            try {
                const response = await CanchasAPI.obtenerTodas();
                
                if (response.success && response.data.length > 0) {
                    container.innerHTML = '';
                    
                    response.data.forEach(cancha => {
                        const canchaCard = crearCanchaCard(cancha);
                        container.appendChild(canchaCard);
                    });
                } else {
                    container.innerHTML = '<p class="no-data">No hay canchas disponibles en este momento.</p>';
                }
                
            } catch (error) {
                console.error('Error cargando canchas:', error);
                container.innerHTML = '<p class="error-message">Error al cargar las canchas. Por favor, intenta nuevamente.</p>';
            }
        }

        function crearCanchaCard(cancha) {
            const card = document.createElement('div');
            card.className = 'cancha-card';
            
            const capacidadTexto = cancha.capacidad === 22 ? 'F√∫tbol 11' : 
                                   cancha.capacidad === 14 ? 'F√∫tbol 7' : 
                                   'F√∫tbol 5';
            
            card.innerHTML = `
                <div class="cancha-header">
                    <h3>${cancha.nombre}</h3>
                    <span class="cancha-badge ${cancha.estado}">${cancha.estado}</span>
                </div>
                <div class="cancha-body">
                    <p class="cancha-capacidad">üë• ${capacidadTexto} (${cancha.capacidad} jugadores)</p>
                    <p class="cancha-precio">${MoneyUtils.formato(cancha.precio_por_hora)}/hora</p>
                    <p class="cancha-descripcion">${cancha.descripcion || 'Cancha de excelente calidad'}</p>
                </div>
                <div class="cancha-footer">
                    <a href="pages/login.html?cancha=${cancha.id}" class="btn btn-primary btn-block">
                        Reservar Ahora
                    </a>
                </div>
            `;
            
            return card;
        }
    </script>
</body>
</html>