<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reservar Cancha - FutbolReservas</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/components.css">
</head>
<body>
    <!-- Header para reservar.html - Reemplaza el header existente -->
<header class="header">
    <div class="container">
        <div class="logo">
            <span class="logo-icon">âš½</span>
            <h1>FutbolReservas</h1>
        </div>
        <nav class="nav" style="display: flex; align-items: center; gap: 1rem;">
            <a href="../index.html" class="nav-link">Inicio</a>
            <a href="reservar.html" class="nav-link active">Reservar</a>
            <a href="#" onclick="irAAdminDesdeReserva(event)" class="nav-link">Panel Admin</a>
            
            <!-- Mostrar usuario actual -->
            <span id="usuarioActual" style="color: white; font-size: 0.9rem; background: rgba(255, 255, 255, 0.1); padding: 0.5rem 1rem; border-radius: 6px;"></span>
            
            <!-- BotÃ³n de cerrar sesiÃ³n -->
            <button onclick="cerrarSesionDesdeReserva()" class="btn btn-outline" style="padding: 0.5rem 1rem; font-size: 0.9rem; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.3); color: white;">
                ðŸšª Cerrar SesiÃ³n
            </button>
        </nav>
    </div>
</header>

<script>
// Mostrar usuario actual
document.addEventListener('DOMContentLoaded', () => {
    const sesionStr = sessionStorage.getItem('sesion');
    const usuarioActual = document.getElementById('usuarioActual');
    
    if (sesionStr && usuarioActual) {
        const sesion = JSON.parse(sesionStr);
        usuarioActual.textContent = `ðŸ‘¤ ${sesion.nombre} ${sesion.apellido}`;
    }
});

function irAAdminDesdeReserva(e) {
    e.preventDefault();
    
    if (confirm('Para acceder al Panel Admin debes cerrar tu sesiÃ³n actual. Â¿Continuar?')) {
        sessionStorage.removeItem('sesion');
        window.location.href = 'login.html?admin=true';
    }
}

function cerrarSesionDesdeReserva() {
    if (confirm('Â¿EstÃ¡s seguro que deseas cerrar sesiÃ³n?')) {
        sessionStorage.removeItem('sesion');
        window.location.href = '../index.html';
    }
}
</script>

<style>
.nav {
    display: flex;
    align-items: center;
    gap: 1rem;
}

.nav .btn-outline:hover {
    background: rgba(255, 255, 255, 0.2) !important;
    border-color: rgba(255, 255, 255, 0.5) !important;
}
</style>

    <section style="padding: 3rem 0; background-color: var(--light-bg);">
        <div class="container">
            <h2 class="section-title">Reservar Cancha</h2>
            
            <div class="card" style="max-width: 800px; margin: 0 auto;">
                <div class="card-body">
                    <form id="formReserva">
                        <!-- Paso 1: InformaciÃ³n del Cliente -->
                        <div id="paso1" class="form-section">
                            <h3 class="mb-3">Paso 1: InformaciÃ³n del Cliente</h3>
                            
                                <div id="datosClienteAuto" class="alert alert-success mb-3" style="display: none; padding: 1rem; border-radius: 8px; background-color: #d4edda; border: 1px solid #c3e6cb; color: #155724;">
                                     <strong>âœ“Datos cargados automÃ¡ticamente</strong>
                                     <p class="mb-0">EstÃ¡s reservando como: <span id="nombreCompleto" style="font-weight: bold;"></span></p>
                                </div>

                                <div class="form-group">
                                     <label class="form-label required" for="telefono">TelÃ©fono</label>
                                     <input type="tel" id="telefono" class="form-input" 
                                            placeholder="Ej: 1123456789" required>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label required" for="nombre">Nombre</label>
                                    <input type="text" id="nombre" class="form-input" required>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label" for="apellido">Apellido</label>
                                    <input type="text" id="apellido" class="form-input" required>
                                </div>

                                <div class="form-group">
                                    <label class="form-label" for="apellido">Email (opcional)</label>
                                    <input type="email" id="email" class="form-input">
                                </div>
                                
                                <button type="button" id="btnSiguiente1" class="btn btn-primary">
                                    Siguiente
                                </button>
                        </div>

                        <!-- Paso 2: SelecciÃ³n de Cancha y Horario -->
                        <div id="paso2" class="form-section d-none">
                            <h3 class="mb-3">Paso 2: SelecciÃ³n de Cancha y Horario</h3>
                            
                            <div class="form-group">
                                <label class="form-label required" for="fecha">Fecha</label>
                                <input type="date" id="fecha" class="form-input" required>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label required" for="cancha">Cancha</label>
                                <select id="cancha" class="form-select" required>
                                    <option value="">Seleccionar cancha...</option>
                                </select>
                            </div>
                            
                            <div id="disponibilidadContainer" class="d-none">
                                <h4 class="mt-3 mb-2">Disponibilidad</h4>
                                <div id="horariosDisponibles" class="grid grid-3 gap-2"></div>
                            </div>
                            
                            <div id="seleccionHorario" class="d-none mt-3">
                                <div class="form-group">
                                    <label class="form-label required" for="horaInicio">Hora de Inicio</label>
                                    <input type="time" id="horaInicio" class="form-input" required>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label required" for="horaFin">Hora de Fin</label>
                                    <input type="time" id="horaFin" class="form-input" required>
                                </div>
                            </div>
                            
                            <div class="flex-between mt-3">
                                <button type="button" id="btnVolver1" class="btn btn-outline">
                                    Volver
                                </button>
                                <button type="button" id="btnSiguiente2" class="btn btn-primary">
                                    Siguiente
                                </button>
                            </div>
                        </div>

                        <!-- Paso 3: ConfirmaciÃ³n y Resumen -->
                        <div id="paso3" class="form-section d-none">
                            <h3 class="mb-3">Paso 3: ConfirmaciÃ³n</h3>
                            
                            <div id="resumenReserva" class="card">
                                <div class="card-body">
                                    <h4 class="mb-3">Resumen de la Reserva</h4>
                                    <div id="detallesResumen"></div>
                                </div>
                            </div>
                            
                            <div class="form-group mt-3">
                                <label class="form-label" for="observaciones">Observaciones</label>
                                <textarea id="observaciones" class="form-textarea" 
                                          placeholder="Notas adicionales (opcional)"></textarea>
                            </div>
                            
                            <div class="flex-between mt-3">
                                <button type="button" id="btnVolver2" class="btn btn-outline">
                                    Volver
                                </button>
                                <button type="submit" id="btnConfirmar" class="btn btn-primary btn-large">
                                    Confirmar Reserva
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </section>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 FutbolReservas - Sistema de Reservas de Canchas</p>
        </div>
    </footer>

    <script src="../js/config.js"></script>
    <script src="../js/api.js"></script>
    <script src="../js/utils.js"></script>
    <script src="../js/auth.js"></script>
    <script>
        // Verificar autenticaciÃ³n antes de cargar la pÃ¡gina
        if (!verificarAutenticacion()) {
            // Redirige automÃ¡ticamente al login
        }
    </script>
    <script src="../js/reservas.js"></script>
    
</body>
</html>